{% extends 'home/base.html' %}
{% block content %}

<div class="container-fluid">
    <div class="row text-center justify-content-center">
        <div class="card mt-2 mb-2">
            <div class="card-body">
                <div class="row">
                    <div class="col-md-9 col-lg-9" align="left">
                        <div class="alert alert-danger text-center justify-content-center">
                           <strong>Project Name :{{project.name}}</strong> <br><br>
                           <p>
                            Total Amount Deposited: Rs.{{tx_total}},  Contributors : {{tx_count}}<br>
                            Total Amount Pledged  : Rs.{{contrib_total}}, Contributors : {{contrib_count}}
                           </p>
                        </div>
                        <strong>Constribution Frequency</strong>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th scope="col">Frequency</th>
                                    <th scope="col">Amount</th>
                                    <th scope="col">Count</th>
                                </tr>
                            </thead>
                            <tbody>
                               {% for cx in freq_list %}
                                <tr>
                                    <td>{{cx.frequency}}</td>
                                    <td>{{cx.amount__sum}} </td>
                                    <td>{{cx.cnt}} </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <hr>
            </div>
        </div>
        <div class="card mt-2 mb-2">
            <div class="card-body">
                <div id="container" style="width: 75%;">
                    <h3>Account Summary for {{project.name}} </h3>
                    <canvas id="bankSummary" data-url={% url 'accounts:bankAccountSummary' project.id %}></canvas>
                 </div>
            </div>
        </div>
    </div>
 </div>
   <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
   <script>
 
     $(function () {
 
       var $financialChart = $("#bankSummary");
       $.ajax({
         url: $financialChart.attr("data-url"),
         dataType: 'json',
         success: function (data) {
 
           var ctx = $financialChart[0].getContext("2d");
 
           new Chart(ctx, {
             type: 'bar',
             data: {
               labels: data.labels,
               datasets: [{
                 label: 'Total',
                 backgroundColor: 'green',
                 data: data.data
               }]          
             },
             options: {
               responsive: true,
               legend: {
                 position: 'top',
               },
               title: {
                 display: true,
                 text: 'Transaction by Bank Accounts'
               }
             }
           });
 
         }
       });
 
     });
     </script>
 
{% include 'home/footer.html' %}
{% endblock content %}